{% extends 'studenttesting/base.html' %}

{% block title %} Список студентов {% endblock %}

{% load static %}

{% block content %}
<!-- menu -->
<p>
	<div class="menu">
		{% for elem in menu %}
			{% if forloop.last %}
				<a href="{{ elem.url }}">{{ elem.name }}</a>
			{% else %}
				<a href="{{ elem.url }}">{{ elem.name }}</a> | 
			{% endif %}
		{% endfor %}
	</div>
</p>
<!-- END menu -->
<h1>Список студентов</h1>
<h2>Преподаватель: {{ full_name }}</h2>
<hr />

<form method="POST">
	{% csrf_token %}
	<table border="0">
		<tr>
			<th><center>Студент</center></th>
			<th><center>Тест</center></th>
			<th><center>Дата прохождения</center></th>
			<th><center>Правильных ответов</center></th>
			<th><center>Неправильных ответов</center></th>
			<th><center>Оценка</center></th>
			<th><center><input type="submit" value="Очистить результат"></center></th>
		</tr>
		{% for student, tests in results.items %}
			<tr>
				{% if tests|length > 1 %}
					<td rowspan='{{ tests|length|add:"1" }}'>{{ student.full_name }}</td>
				{% else %}
					<td rowspan='{{ tests|length|add:"1" }}'>{{ student.full_name }}</td>
					{% if tests|length == 0 %}
						<td colspan="5" align="center">Нет пройденных тестов</td>
					{% endif %}
				{% endif %}
			</tr>
			{% if tests|length != 0 %}
				{% for test, data in tests.items %}
				<tr>
					<td>{{ test.name }}</td>
					<td align="center">{{ data.date }}</td>
					<td align="center">{{ data.positive }}</td>
					<td align="center">{{ data.negative }}</td>
					<td align="center">{{ data.raiting }}</td>
					<td align="center"> <input type="checkbox" name="student_{{ student.id }}" value="test_{{ test.id }}" /></td>
				</tr>
				{% endfor %}
			{% endif %}
		{% endfor %}
	</table>
</form>
{% endblock %}